let jwt;_227‍.x([["verifyToken",()=>verifyToken],["default",()=>_227‍.o]]);_227‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);



const JwtToken = async ({ type = 'SignUp', data, expiresIn = '1d' }) => {
    let secret = '';
    if (type === 'SignUp') {
        secret = process.env.USER_AUTH_JWT_SECRET
    } else if (type === 'File') {
        secret = process.env.FILE_ACCESS_JWT_SECRET
    }
    const token = await jwt.sign({ data }, secret, { expiresIn })
    return token;
}

       const verifyToken = async ({ type = 'SignUp', token }) => {
    try {
        let secret = '';
        if (type === 'SignUp') {
            secret = process.env.USER_AUTH_JWT_SECRET
        } else if (type === 'File') {
            secret = process.env.FILE_ACCESS_JWT_SECRET
        }
        _227‍.g.console.log(secret)
        return await jwt.verify(token, secret, (err, decoded) => {
            _227‍.g.console.log({ err, decoded })
            if (err) {
                return {
                    error: err || 'Token expires'
                };
            }
            return decoded;
        })
    } catch (error) {
        return { error: error && error.message || 'Invalid token' };
    }
}
_227‍.d(JwtToken);